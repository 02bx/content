<Profile id="nist-800-171-cui">
<title>RHEL7 Server Baseline for Controlled Unclassified Information in Nonfederal Information Systems and Organizations (NIST 800-171)</title>
<description override="true">

From NIST 800-171, Section 2.2:
Security requirements for protecting the confidentiality of CUI in nonfederal information systems
and organizations have a well-defined structure that consists of: (i) a basic security requirements section;
and (ii) a derived security requirements section. The basic security requirements are obtained from FIPS
Publication 200, which provides the high-level and fundamental security requirements for federal information
and information systems. The derived security requirements, which supplement the basic security requirements,
are taken from the security controls in NIST Special Publication 800-53. 

This profile configures Red Hat Enterprise Linux 7 to the NIST Special Publication 800-53 controls identified 
for securing Controlled Unclassified Information (CUI).
</description>

<!-- NIST 800-171 can be found here:
     http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf
-->

<!-- 3.1.1	Limit information system access to authorized users, processes acting on behalf
     		of authorized users, or devices (including other information systems) -->
<select idref="no_direct_root_logins" selected="true" />
<select idref="securetty_root_login_console_only" selected="true" />
<select idref="restrict_serial_port_logins" selected="true" />
<select idref="accounts_no_uid_except_zero" selected="true" />
<select idref="no_empty_passwords" selected="true" />
<select idref="sshd_disable_root_login" selected="true" />
<select idref="sshd_disable_empty_passwords" selected="true" />
<select idref="require_singleuser_auth" selected="true" />
<select idref="gnome_gdm_disable_automatic_login" selected="true" />
<select idref="gnome_gdm_disable_guest_login" selected="true" />

<!-- 3.1.2	Limit information system access to the types of transactions and functions that
     		authorized users are permitted to execute. -->
<refine-value idref="var_selinux_state" selector="enforcing"/>
<refine-value idref="var_selinux_policy_name" selector="targeted" />

<select idref="enable_selinux_bootloader" selected="true" />
<select idref="selinux_state" select="true" />
<select idref="selinux_policytype" selected="true" />
<select idref="selinux_confinement_of_daemons" selected="true" />
<select idref="selinux_all_devicefiles_labeled" selected="true" />
<select idref="disable_interactive_boot" selected="true" />
<select idref="dconf_gnome_disable_restart_shutdown" selected="true" />
<select idref="dconf_gnome_disable_ctrlaltdel_reboot" selected="true" />
<!-- TO DO: sebooleans? -->

<!-- 3.1.3	Control the flow of CUI in accordance with approved authorizations -->
<select idref="service_firewalld_enabled" selected="true" />
<select idref="set_firewalld_default_zone" selected="true" />

<!-- 3.1.4	Separate the duties of individuals to reduce the risk of malevolent activity without
     		collusion. -->

<!-- TO DO: organizational control mappings -->

<!-- 3.1.5	Employ the principal of least privilege, including for specific security functions
     		and privileged accounts. -->
<!-- Rules enabled elsewhere but mapped to this control:
     	- selinux_confinement_of_daemons
	- selinux_all_devicefiles_labeled -->
<select idref="dconf_gnome_disable_user_admin" selected="true" />
<select idref="sysctl_kernel_dmesg_restrict" selected="true" />

<!-- 3.1.6	Use non-privileged accounts or roles when accessing nonsecurity functions. -->

<!-- Rules enabled elsewhere but mapped to this control:
     	- no_direct_root_logins
	- securetty_root_login_console_only
	- restrict_serial_port_logins
	- accounts_no_uid_except_zero
	- no_empty_passwords
	- sshd_disable_root_login
	- sshd_disable_empty_passwords
-->

<!-- 3.1.7	Prevent non-privileged users from executing privileged functions and audit
     		the execution of such functions. -->
<select idref="audit_rules_execution_semanage" selected="true" />
<select idref="audit_rules_execution_setsebool" selected="true" />
<select idref="audit_rules_execution_chcon" selected="true" />
<select idref="audit_rules_execution_restorecon" selected="true" />
<select idref="audit_rules_privileged_commands" selected="true" />
<select idref="audit_rules_privileged_commands_passwd" selected="true" />
<select idref="audit_rules_privileged_commands_chkpwd" selected="true" />
<select idref="audit_rules_privileged_commands_gpasswd" selected="true" />
<select idref="audit_rules_privileged_commands_sudo" selected="true" />
<select idref="audit_rules_privileged_commands_chage" selected="true" />
<select idref="audit_rules_privileged_commands_usrhelpr" selected="true" />
<select idref="audit_rules_privileged_commands_su" selected="true" />
<select idref="audit_rules_privileged_commands_sudoedit" selected="true" />
<select idref="audit_rules_privileged_commands_newgrp" selected="true" />
<select idref="audit_rules_privileged_commands_chsh" selected="true" />
<select idref="audit_rules_privileged_commands_umount" selected="true" />
<select idref="audit_rules_privileged_commands_postdrop" selected="true" />
<select idref="audit_rules_privileged_commands_postqueue" selected="true" />
<select idref="audit_rules_privileged_commands_ssh_keysign" selected="true" />
<select idref="audit_rules_privileged_commands_pt_chown" selected="true" />
<select idref="audit_rules_privileged_commands_crontab" selected="true" />
<select idref="audit_rules_privileged_commands_pam_timestamp_check" selected="true" />
<select idref="audit_rules_media_export" selected="true" />
<select idref="audit_rules_file_deletion_events" selected="true" />
<select idref="audit_rules_file_deletion_events_rmdir" selected="true" />
<select idref="audit_rules_file_deletion_events_unlink" selected="true" />
<select idref="audit_rules_file_deletion_events_unlinkat" selected="true" />
<select idref="audit_rules_file_deletion_events_rename" selected="true" />
<select idref="audit_rules_file_deletion_events_renameat" selected="true" />
<select idref="audit_rules_sysadmin_actions" selected="true" />
<select idref="audit_rules_kernel_module_loading" selected="true" />
<select idref="audit_rules_kernel_module_loading_init" selected="true" />
<select idref="audit_rules_kernel_module_loading_insmod" selected="true" />
<select idref="audit_rules_kernel_module_loading_rmmod" selected="true" />
<select idref="audit_rules_kernel_module_loading_modprobe" selected="true" />
<select idref="dconf_gnome_disable_automount" selected="true" />
<select idref="sysctl_kernel_exec_shield" selected="true" />
<select idref="sysctl_kernel_randomize_va_space" selected="true" />
<select idref="install_PAE_kernel_on_x86" selected="true" />
<select idref="bios_enable_execution_restrictions" selected="true" />

<!-- 3.1.8	Limit unsuccessful logon attempts -->
<refine-value idref="var_accounts_passwords_pam_faillock_deny" selector="3" />
<refine-value idref="var_accounts_passwords_pam_faillock_unlock_time" selector="never" />
<refine-value idref="var_accounts_passwords_pam_faillock_fail_interval" selector="900" />

<select idref="accounts_passwords_pam_faillock_deny" selected="true" />
<select idref="accounts_passwords_pam_faillock_unlock_time" selected="true" />
<select idref="accounts_passwords_pam_faillock_interval" selected="true" />
<select idref="dconf_gnome_login_retries" selected="true" />

<!-- 3.1.9	Provide privacy and security notices consistent with applicable CUI rules. -->
<refine-value idref="login_banner_text" selector="usgcb_default" />

<select idref="sshd_enable_warning_banner" selected="true" />
<select idref="banner_etc_issue" selected="true" />
<select idref="dconf_gnome_banner_enabled" selected="true" />
<select idref="dconf_gnome_login_banner_text" selected="true" />

<!-- 3.1.10	Use session lock with pattern-hiding displays to prevent access/viewing of
     		data after period of inactivity -->
<refine-value idref="inactivity_timeout_value" selector="10_minutes" />

<select idref="package_screen_installed" selected="true" />
<select idref="dconf_gnome_screensaver_idle_delay" selected="true" />
<select idref="dconf_gnome_screensaver_idle_activation_enabled" selected="true" />
<select idref="dconf_gnome_screensaver_lock_enabled" selected="true" />
<select idref="dconf_gnome_screensaver_lock_delay" selected="true" />
<select idref="dconf_gnome_screensaver_mode_blank" selected="true" />
<select idref="dconf_gnome_screensaver_user_info" selected="true" />
<select idref="dconf_gnome_session_user_locks" selected="true" />

<!-- 3.1.11	Terminate (automatically) a user session after a defined condition -->
<refine-value idref="var_accounts_tmout" selector="10_min" />
<refine-value idref="sshd_idle_timeout_value" selector="10_minutes" />

<select idref="accounts_tmout" selected="true" />
<select idref="sshd_set_keepalive" selected="true" />
<select idref="sshd_set_idle_timeout" selected="true" />

<!-- 3.1.12	Monitor and control remote access sessions -->
<select idref="firewalld_sshd_disabled" selected="true" />
<select idref="firewalld_sshd_port_enabled" selected="true" />
<select idref="sshd_limit_user_access" selected="true" />
<select idref="sshd_disable_gssapi_auth" selected="true" />
<select idref="sshd_disable_kerb_auth" selected="true" />
<select idref="sshd_enable_strictmodes" selected="true" />
<select idref="sshd_use_priv_separation" selected="true" />
<select idref="sshd_disable_compression" selected="true" />
<select idref="sshd_disable_rhosts" selected="true" />
<select idref="sshd_disable_user_known_hosts" selected="true" />
<select idref="sshd_disable_rhosts_rsa" selected="true" />
<select idref="disable_host_auth" selected="true" />
<select idref="sshd_do_not_permit_user_env" selected="true" />
<select idref="dconf_gnome_remote_access_credential_prompt" selected="true" />

<!-- 3.1.13	Employ cryptographic mechanisms to protect the confidentiality of remote 
     		access sessions -->
<select idref="service_sshd_enabled" selected="true" />
<select idref="file_permissions_sshd_pub_key" selected="true" />
<select idref="file_permissions_sshd_private_key" selected="true" />
<select idref="sshd_allow_only_protocol2" selected="true" />
<select idref="enable_x11_forwarding" selected="true" />
<select idref="sshd_use_approved_ciphers" selected="true" />
<select idref="sshd_use_approved_macs" selected="true" />
<select idref="dconf_gnome_remote_access_encryption" selected="true" />

<!-- 3.1.14	Route remote access via managed control points -->
<!-- Organizational control -->

<!-- 3.1.15	Authorize remote execution of privileged commands and remote access
     		to security-relevant information -->
<!-- N/A, remote execution same as local from RHEL perspective -->

<!-- 3.1.16	Authorize wireless access prior to allowing such connections -->
<select idref="dconf_gnome_disable_wifi_create" selected="true" />
<select idref="dconf_gnome_disable_wifi_notification" selected="true" />
<select idref="wireless_disable_interfaces" selected="true" />
<select idref="service_bluetooth_disabled" selected="true" />
<select idref="kernel_module_bluetooth_disabled" selected="true" />

<!-- 3.1.17	Protect wireless access using authentication and encryption -->
<!-- TO DO -->

<!-- 3.1.18	Control connection of mobile devices -->
<!-- TO DO: Not Applicable -->

<!-- 3.1.19	Encrypt CUI on mobile devices -->
<!-- TO DO: Not Applicable -->

<!-- 3.1.20	Verify and control/limit connections to and use of external
     		information systems -->
<select idref="sysctl_kernel_ipv6_disable" selected="true" />
<select idref="network_ipv6_disable_interfaces" selected="true" />
<select idref="network_ipv6_disable_rpc" selected="true" />
<select idref="sysctl_net_ipv6_conf_all_accept_source_route" selected="true" />
<select idref="sysctl_net_ipv6_conf_all_accept_ra" selected="true" />
<select idref="sysctl_net_ipv6_conf_default_accept_ra" selected="true" />
<select idref="sysctl_net_ipv6_conf_all_accept_redirects" selected="true" />
<select idref="sysctl_net_ipv6_conf_default_accept_redirects" selected="true" />
<select idref="sysctl_net_ipv6_conf_default_accept_source_route" selected="true" />
<select idref="sysctl_net_ipv6_conf_all_forwarding" selected="true" />
<select idref="network_ipv6_privacy_extensions" selected="true" />
<select idref="sysctl_net_ipv4_conf_default_send_redirects" selected="true" />
<select idref="sysctl_net_ipv4_conf_all_send_redirects" selected="true" />
<select idref="sysctl_net_ipv4_ip_forward" selected="true" />
<select idref="sysctl_net_ipv4_conf_all_accept_source_route" selected="true" />
<select idref="sysctl_net_ipv4_conf_all_accept_redirects" selected="true" />
<select idref="sysctl_net_ipv4_conf_all_secure_redirects" selected="true" />
<select idref="sysctl_net_ipv4_conf_all_log_martians" selected="true" />
<select idref="sysctl_net_ipv4_conf_default_log_martians" selected="true" />
<select idref="sysctl_net_ipv4_conf_default_accept_source_route" selected="true" />
<select idref="sysctl_net_ipv4_conf_default_accept_redirects" selected="true" />
<select idref="sysctl_net_ipv4_conf_default_secure_redirects" selected="true" />
<select idref="sysctl_net_ipv4_icmp_echo_ignore_broadcasts" selected="true" />
<select idref="sysctl_net_ipv4_icmp_ignore_bogus_error_responses" selected="true" />
<select idref="sysctl_net_ipv4_tcp_syncookies" selected="true" />
<select idref="sysctl_net_ipv4_conf_all_rp_filter" selected="true" />
<select idref="sysctl_net_ipv4_conf_default_rp_filter" selected="true" />

<!-- 3.1.21	Limit use of organizational portable storage devices on 
     		external information systems -->

<!-- 3.1.22	Control information posted or processed on publicly accessible
     		information systems -->

<!-- 3.2 AWARENESS TRAINING -->

<!-- 3.2.1	Ensure that managers, systems administrators, and users or organizational
		information systems are made aware of the security risks associated with 
		their activities and of the applicable policies, standards, and procedures
		related to the security of organizational information systems -->

<!-- 3.2.2	Ensure that organizational personnel are adequately trained to carry out
     		their assigned information security-related duties and responsibilities -->

<!-- 3.2.3	Provide security awareness training on recognizing and reporting potential
     		indicators of insider threat -->

<!-- 3.3.1	Create, protect, and retain information system audit records to the extent
     		needed to enable the monitoring, analysis, investigation, and reporting
		of unlawful, unauthorized, or inappropraite information system activitiy -->

<!-- 3.3.2	Ensure that the actions of individual information system users can be uniquely
     		traced to those users so they can be held accountable for their actions -->

<!-- 3.3.3	Review and update audited events -->

<!-- 3.3.4	Alert in the event of an audit process failure -->

<!-- 3.3.5	Correlate audit review, analysis, and reporting processes for investigation
     		and repsonse to indications of inappropraite, suspicious, or unusual activity -->

<!-- 3.3.6	Provide audit reduction and report generation to support on-demand analysis
     		and reporting -->

<!-- 3.3.7	Provide an information system capability that compares and synchronizes internal
     		system clocks with an authoritative source to generate time stamps for audit
		records -->

<!-- 3.3.8	Protect audit information and audit tools from unauthorized access, modification,
     		and deletion -->

<!-- 3.3.9	Limit management of audit functionality to a subset of privileged users -->

<!-- 3.4. CONFIGURATION MANAGEMENT -->

<!-- 3.4.1	Establish and maintain baseline configurations and inventories of organizational
     		information systems (including hardware, software, firmware, and documentation)
		throughout the respective system development life cycles -->

<!-- 3.4.2	Establish and enforce security configuration setting for information technology
     		products employed in organizational information systems -->

<!-- 3.4.3	Track, review, approve/disapprove, and audit changes to information systems -->

<!-- 3.4.4	Analyze the security impact of changes prior to implementation -->

<!-- 3.4.5	Define, document, approve, and enforce physical and logical access restrictions
     		associated with changes to the information system -->     	


<!-- things that dont' fit cleanly elsewhere -->
<select idref="audit_rules_immutable" selected="true" />
<select idref="enable_dconf_user_profile" selected="true" />
<select idref="dconf_gnome_disable_user_list" selected="true" />
<select idref="dconf_gnome_disable_geolocation" selected="true" />
<select idref="dconf_gnome_disable_thumbnailers" selected="true" />
</Profile>
