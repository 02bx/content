<def-group>
  <definition class="compliance"
  id="audit_rule_kernel_module_loading" version="1">
    <metadata>
      <title>Ensure auditd Collects Information on Kernel Module
      Loading and Unloading</title>
      <affected family="unix">
        <platform>Red Hat Enterprise Linux 6</platform>
      </affected>
      <reference ref_id="CCE-14688-6" source="CCE" />
      <description>Audit rules about the Information on Kernel
      Module Loading and Unloading.</description>
    </metadata>
    <criteria operator="AND">
      <criterion comment="/etc/audit/audit.rules contains -w /sbin/insmod -p x -k modules"
      test_ref="test_2016851" />
      <criterion comment="/etc/audit/audit.rules contains -w /sbin/rmmod -p x -k modules"
      test_ref="test_2016852" />
      <criterion comment="/etc/audit/audit.rules contains -w /sbin/modprobe -p x -k modules"
      test_ref="test_2016853" />
      <criterion comment="/etc/audit/audit.rules contains -a always,exit -S init_module -S delete_module -k modules"
      test_ref="test_2016854" />
    </criteria>
  </definition>
  <ind:textfilecontent54_test check="all"
  check_existence="at_least_one_exists"
  comment="/etc/audit/audit.rules contains -w /sbin/insmod -p x -k modules"
  id="test_2016851" version="1">
    <ind:object object_ref="obj_2016851" />
  </ind:textfilecontent54_test>
  <ind:textfilecontent54_object id="obj_2016851"
  version="1">
    <ind:path>/etc/audit</ind:path>
    <ind:filename>audit.rules</ind:filename>
    <ind:pattern operation="pattern match">^\-w\s/sbin/insmod\s\-p\sx\s\-k\smodules$</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
  <ind:textfilecontent54_test check="all"
  check_existence="at_least_one_exists"
  comment="/etc/audit/audit.rules contains -w /sbin/rmmod -p x -k modules"
  id="test_2016852" version="1">
    <ind:object object_ref="obj_2016852" />
  </ind:textfilecontent54_test>
  <ind:textfilecontent54_object id="obj_2016852"
  version="1">
    <ind:path>/etc/audit</ind:path>
    <ind:filename>audit.rules</ind:filename>
    <ind:pattern operation="pattern match">^\-w\s/sbin/rmmod\s\-p\sx\s\-k\smodules$</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
  <ind:textfilecontent54_test check="all"
  check_existence="at_least_one_exists"
  comment="/etc/audit/audit.rules contains -w /sbin/modprobe -p x -k modules"
  id="test_2016853" version="1">
    <ind:object object_ref="obj_2016853" />
  </ind:textfilecontent54_test>
  <ind:textfilecontent54_object id="obj_2016853"
  version="1">
    <ind:path>/etc/audit</ind:path>
    <ind:filename>audit.rules</ind:filename>
    <ind:pattern operation="pattern match">
    ^\-w\s/sbin/modprobe\s\-p\sx\s\-k\smodules$</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
  <ind:textfilecontent54_test check="all"
  check_existence="at_least_one_exists"
  comment="/etc/audit/audit.rules contains -a always,exit -S init_module -S delete_module -k modules"
  id="test_2016854" version="1">
    <ind:object object_ref="obj_2016854" />
  </ind:textfilecontent54_test>
  <ind:textfilecontent54_object id="obj_2016854"
  version="1">
    <ind:path>/etc/audit</ind:path>
    <ind:filename>audit.rules</ind:filename>
    <ind:pattern operation="pattern match">^\-a\salways,exit\s(?:-F arch=b[36][24]\s)?\-S\sinit_module\s\-S\sdelete_module\s\-k\smodules\s*$</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
</def-group>
