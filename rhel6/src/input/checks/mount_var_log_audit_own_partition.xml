<def-group>
  <definition class="compliance" id="mount_var_log_audit_own_partition" version="1">
    <metadata>
      <title>Ensure /var/log/audit Located On Separate Partition</title>
      <affected family="unix">
        <platform>Red Hat Enterprise Linux 6</platform>
      </affected>
      <reference ref_id="CCE-14171-3" source="CCE" />
      <description>Audit logs are stored in the /var/log/audit directory.
      Ensure that it has its own partition or logical volume. Make
      absolutely certain that it is large enough to store all audit logs
      that will be created by the auditing daemon.</description>
    </metadata>
    <criteria operator="AND">
      <criterion test_ref="test_var_log_audit_partition" comment="check for /var/log/audit partition" />
      <criterion test_ref="test_etc_fstab_var_log_audit" comment="find /var/log/audit in /etc/fstab" />
    </criteria>
  </definition>

  <linux:partition_test check="all" check_existence="all_exist" id="test_var_log_audit_partition" version="1" comment="check for /var/log/audit partition">
      <linux:object object_ref="object_var_log_audit_partition" />
  </linux:partition_test>

  <linux:partition_object id="object_var_log_audit_partition" version="1">
      <linux:mount_point>/var/log/audit</linux:mount_point>
  </linux:partition_object>

  <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="find /var/log/audit in /etc/fstab" id="test_etc_fstab_var_log_audit" version="1">
    <ind:object object_ref="object_etc_fstab_var_log_audit" />
  </ind:textfilecontent54_test>

  <ind:textfilecontent54_object id="object_etc_fstab_var_log_audit" version="1" comment="find /var/log/audit in /etc/fstab">
    <ind:path>/etc</ind:path>
    <ind:filename>fstab</ind:filename>
    <ind:pattern operation="pattern match">^.*\s/var/log/audit\s.*$</ind:pattern>
    <ind:instance datatype="int" operation="equals">1</ind:instance>
  </ind:textfilecontent54_object>
</def-group>
