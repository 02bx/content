<def-group>
  <definition class="compliance" id="mount_var_own_partition" version="1">
    <metadata>
      <title>Ensure /var Located On Separate Partition</title>
      <affected family="unix">
        <platform>Red Hat Enterprise Linux 6</platform>
      </affected>
      <reference ref_id="CCE-14777-7" source="CCE" />
      <description>Ensuring that /var is mounted on its own partition enables the
      setting of more restrictive mount options, which is used as temporary
      storage by many program, particularly system services such as daemons.
      It is not uncommon for the /var directory to contain world-writable directories,
      installed by other software packages.</description>
    </metadata>
    <criteria operator="AND">
      <criterion test_ref="test_var_partition" comment="check for /var partition" />
      <criterion test_ref="test_etc_fstab_var" comment="find /var in /etc/fstab" />
    </criteria>
  </definition>

  <linux:partition_test check="all" check_existence="all_exist" id="test_var_partition" version="1" comment="check for /var partition">
      <linux:object object_ref="object_var_partition" />
  </linux:partition_test>

  <linux:partition_object id="object_var_partition" version="1">
      <linux:mount_point>/var</linux:mount_point>
  </linux:partition_object>

  <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="find /var in /etc/fstab" id="test_etc_fstab_var" version="1">
    <ind:object object_ref="object_etc_fstab_var" />
  </ind:textfilecontent54_test>

  <ind:textfilecontent54_object id="object_etc_fstab_var" version="1" comment="find /var in /etc/fstab">
    <ind:path>/etc</ind:path>
    <ind:filename>fstab</ind:filename>
    <ind:pattern operation="pattern match">^.*\s/var\s.*$</ind:pattern>
    <ind:instance datatype="int" operation="equals">1</ind:instance>
  </ind:textfilecontent54_object>
</def-group>
