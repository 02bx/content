<Group id="accounts-physical">
<title>Protect Physical Console Access</title>
<description>It is impossible to fully protect a system from an
attacker with physical access, so securing the space in which the
system is located should be considered a necessary step. However,
there are some steps which, if taken, make it more difficult for an
attacker to quickly or undetectably modify a system from its
console.</description>
<Group id="bootloader">
<title>Set Boot Loader Password</title>
<description>During the boot process, the boot loader is
responsible for starting the execution of the kernel and passing
options to it. The boot loader allows for the selection of
different kernels â€“ possibly on different partitions or media.
Options it can pass to the kernel include 'single-user mode,' which
provides root access without any authentication, and the ability to
disable SELinux. To prevent local users from modifying the boot
parameters and endangering security, the boot loader configuration
should be protected with a password.
<br /><br />
The default RHEL boot loader for x86 systems is called GRUB.
To protect its configuration:
<br />
<ol>
<li>Select a password and then generate a hash from it by running:
<br />
<pre>
# grub-md5-crypt

</pre>
</li>
<li>Insert the following line into <tt>/etc/grub.conf</tt> immediately
after the header comments. (Use the output from <tt>grub-md5-crypt</tt> as the
value of <b>password-hash</b>):
<br />
<pre>
password --md5 <b>password-hash</b>

</pre>
</li>
<li>Verify the permissions on <tt>/etc/grub.conf</tt> (which is a symlink to
<tt>../boot/grub/grub.conf</tt>):
<br />
<pre>
# chown root:root /etc/grub.conf
# chmod 600 /etc/grub.conf

</pre></li>
</ol>Boot loaders for other platforms should offer a similar
password protection feature.</description>

<Value id="file_owner_etc_grub_conf_value" type="string" operator="equals">
<title>User that owns /etc/grub.conf</title>
<description xml:lang="en-US">Choose user that should own /etc/grub.conf</description>
<value selector="root">root</value>
</Value>

<Value id="file_groupowner_etc_grub_conf_value" type="string" operator="equals">
<title>Group that owns /etc/grub.conf</title>
<description xml:lang="en-US">Choose group that should own /etc/grub.conf</description>
<value selector="root">root</value>
</Value>




<Rule id="userowner_grub.conf">
<title>Verify /boot/grub/grub.conf User Ownership</title>
<description>The file /etc/grub.conf is a symbolic link to /boot/grub/grub.conf which
should be owned by the root user to prevent destruction or modification of the file.</description>
<ident cce="4144-2" />
<oval id="file_owner_etc_grub_conf" value="file_owner_etc_grub_conf_value" />
<ref nist="AC-3, CM-6"/>
</Rule>


<Rule id="groupowner_grub.conf">
<title>Verify /boot/grub/grub.conf Group Ownership</title>
<description>The file /etc/grub.conf is a symbolic link to /boot/grub/grub.conf which
should be owned by the root group to prevent destruction or modification of the file.</description>
<ident cce="4197-0" />
<oval id="file_groupowner_etc_grub_conf" value="file_groupowner_etc_grub_conf_value"/>
<ref nist="AC-3, CM-6"/>
</Rule>

<Rule id="perms_grub.conf">
<title>Verify /boot/grub/grub.conf Permissions</title>
<description>File permissions for /boot/grub/grub.conf should be set correctly.</description>
<ident cce="3923-0" />
<oval id="file_permissions_etc_grub_conf" />
<ref nist="AC-3, CM-6"/>
</Rule>

<Rule id="bootloader_password">
<title>Set Boot Loader Password</title>
<description>The grub boot loader should have password protection
enabled</description>
<ident cce="3818-2" />
<oval id="bootloader_password" />
<ref nist="CM-7, IA-5, AC-3"/>
</Rule>

</Group>
<Group id="singleuser_auth">
<title>Require Authentication for Single-User Mode</title>
<description>Single-user mode is intended as a system recovery
method, providing a single user root access to the system by
providing a boot option at startup. By default, no authentication
is performed if single-user mode is selected. This provides a
trivial mechanism of bypassing security on the machine and gaining
root access.
<br /><br />
To require entry of the root password even if the system is
started in single-user mode, add or correct the following line in the
file <tt>/etc/sysconfig/init</tt>:
<br />
<pre>
SINGLE=/sbin/sulogin</pre>
</description>

<Rule id="require_singleuser_auth">
<title>Require Single User Mode Authentication</title>
<description>The requirement for a password to boot into
single-user mode should be enabled.</description>
<ident cce="4241-6" />
<oval id="singleuser_password" />
<ref nist="AC-6, IA-5"/>
</Rule>
</Group>

<Group id="interactive_boot">
<title>Disable Interactive Boot</title>
<description>Edit the file <tt>/etc/sysconfig/init</tt>. Add or correct the
setting:
<br />
<pre>
PROMPT=no

</pre>
The <tt>PROMPT</tt> option allows the console user to perform an
interactive system startup, in which it is possible to select the
set of services which are started on boot. Using interactive boot,
the console user could disable auditing, firewalls, or other
services, weakening system security.</description>

<Rule id="disable_interactive_boot">
<title>Disable Interactive Boot</title>
<description>The ability for users to perform interactive startups
should be disabled.</description>
<ident cce="4245-7" />
<oval id="interactive_boot_disable" />
<ref nist="CM-7, IA-4, SC-2"/>
</Rule>
</Group>

<Group id="screen_locking">
<title>Configure Screen Locking</title>
<description>When a user must temporarily leave an account
logged-in, screen locking should be employed to prevent passersby
from abusing the account. User education and training is
particularly important for screen locking to be effective.
<br /><br />
A policy should be implemented that trains all users to lock
the screen when they plan to temporarily step away from a logged-in
account. Automatic screen locking is only meant as a safeguard for
those cases where a user forgot to lock the screen.</description>
<Group id="gui_screen_locking">
<title>Configure GUI Screen Locking</title>
<description>In the default GNOME desktop, the screen can be locked
by choosing Lock Screen from the System menu.
<br /><br />
The <tt>gconftool-2</tt> program can be used to enforce mandatory
screen locking settings for the default GNOME environment. Run the
following commands to enforce idle activation of the screen saver,
screen locking, a blank-screen screensaver, and 15-minute idle
activation time:
<br />
<pre>
# gconftool-2 --direct \
  --config-source xml:readwrite:/etc/gconf/gconf.xml.mandatory \
  --type bool \
  --set /apps/gnome-screensaver/idle_activation_enabled true
# gconftool-2 --direct \
  --config-source xml:readwrite:/etc/gconf/gconf.xml.mandatory \
  --type bool \
  --set /apps/gnome-screensaver/lock_enabled true
# gconftool-2
  --direct \
  --config-source xml:readwrite:/etc/gconf/gconf.xml.mandatory \
  --type string \
  --set /apps/gnome-screensaver/mode blank-only
# gconftool-2
  --direct \
  --config-source xml:readwrite:/etc/gconf/gconf.xml.mandatory \
  --type int \
  --set /apps/gnome-screensaver/idle_delay 15

</pre>
The default setting of 15 minutes for idle activation is
reasonable for many office environments, but the setting should
conform to whatever policy is defined. The screensaver mode
blank-only is selected to conceal the contents of the display from
passersby.
<br /><br />
Because users should be trained to lock the screen when they
step away from the computer, the automatic locking feature is only
meant as a backup. The Lock Screen icon from the System menu can
also be dragged to the taskbar in order to facilitate even more
convenient screen-locking.
<br /><br />
The root account cannot be screen-locked, but this should
have no practical effect as the root account should never be used
to log into an X Windows environment, and should only be used to
for direct login via console in emergency circumstances.
<br /><br />
For more information about configuring GNOME screensaver, see
http://live.gnome.org/GnomeScreensaver. For more information about
enforcing preferences in the GNOME environment using the GConf
configuration system, see http://projects.gnome.org/gconf and
the man page <tt>gconftool-2(1)</tt>.</description>
<Value id="inactivity_timeout_value" type="string"
operator="equals">
<title>Inactivity timeout</title>
<description>Choose allowed duration of inactive SSH connections,
shells, and X sessions</description>
<value>15</value>
<value selector="0_minutes">0</value>
<value selector="10_minutes">10</value>
<value selector="15_minutes">15</value>
</Value>

<Rule id="set_screensaver_inactivity_timeout">
<title>Set GNOME Login Inactivity Timeout</title>
<description>The idle time-out value for period of inactivity GNOME
desktop lockout should be 15 minutes.</description>
<ident cce="3315-9" />
<oval id="gconf_gnome-screensaver_idle_delay" value="inactivity_timeout_value" />
<ref nist="AC-3, CM-6, CM-7, AC-11" />
</Rule>

<Rule id="enable_screensaver_after_idle">
<title>GNOME Desktop Screensaver Mandatory Use</title>
<description>Idle activation of the screen saver should be
enabled</description>
<ident cce="14604-3" />
<oval id="gconf_gnome-screensaver_idle_activation_enabled" />
<ref nist="CM-6, CM-7" />
</Rule>

<Rule id="enable_screensaver_password_lock">
<title>Implement Screensaver Idle Activation</title>
<description>Idle activation of the screen lock should be
enabled</description>
<ident cce="14023-6" />
<oval id="gconf_gnome-screensaver_idle_activation_enabled" />
<ref nist="AC-3, CM-6, CM-7, AC-11" />
</Rule>

<Rule id="set_blank_screensaver">
<title>Implement Blank Screen Saver</title>
<description>The screen saver should be blank</description>
<ident cce="14735-5" />
<oval id="gconf_gnome-screensaver_mode_blank" />
<ref nist="CM-6, CM-7" />
</Rule>

</Group>

<Group id="console_screen_locking">
<title>Configure Console Screen Locking</title>
<description>A console screen locking mechanism is provided in the
vlock package, which is not installed by default. If the ability to
lock console screens is necessary, install the vlock package:
<br />
<pre>
# yum install vlock

</pre>
Instruct users to invoke the program when necessary, in order
to prevent passersby from abusing their login:
<br />
<pre>
$ vlock

</pre>
The <tt>-a</tt> option can be used to prevent switching to other
virtual consoles.</description>

<Rule id="install_vlock_package">
<title>Configure Console Screen Locking</title>
<description>The vlock package should be installed</description>
<ident cce="3910-7" />
<oval id="package_vlock_installed" />
<ref nist="CM-6, CM-7" />
</Rule>
</Group>
</Group>
</Group>
