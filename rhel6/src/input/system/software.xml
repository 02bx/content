<Group id="software">
<title>Installing and Maintaining Software</title>
<description>The following sections contain information on
security-relevant choices during the initial operating system
installation process and the setup of software
updates.</description>

<Group id="disk_partitioning">
<title>Disk Partitioning</title>
<description>Some system directories should be placed on their own
partitions (or logical volumes). This allows for better separation
and protection of data.
<br />The installer’s default partitioning scheme creates separate
partitions (or logical volumes) for /, /boot, and swap.
<br />
<ul>
<li>If starting with any of the default layouts, check the box to
“Review and modify partitioning.” This allows for the easy creation
of additional logical volumes inside the volume group already
created, though it may require making /’s logical volume smaller to
create space. In general, using logical volumes is preferable to
using partitions because they can be more easily adjusted
later.</li>
<li>If creating a custom layout, create the partitions mentioned in
the previous paragraph (which the installer will require anyway),
as well as separate ones described in the following sections.</li>
</ul>
<br />If a system has already been installed, and the default
partitioning scheme was used, it is possible but nontrivial to
modify it to create separate logical volumes for the directories
listed above. The Logical Volume Manager (LVM) makes this possible.
See the LVM HOWTO at http://tldp.org/HOWTO/LVM-HOWTO/ for more
detailed information on LVM.</description>

<Rule id="partition_for_tmp">
<title>Ensure that /tmp has its own partition or logical volume</title>
<description>The /tmp directory is a world-writable directory used
for temporary ﬁle storage. Ensure that it has its own partition or
logical volume.</description>
<rationale>
Placing /tmp in its own partition enables the setting of more restrictive 
mount options, which is used as temporary storage
by many programs (sometimes insecurely).
</rationale>
<ident cce="14161-4" />
<oval id="20000" />
<ref nist="CM-6"/>
</Rule>

<Rule id="partition_for_var">
<title>Ensure that /var has its own partition or logical volume</title>
<description>The /var directory is used by daemons and other system
services to store frequently-changing data. 
Ensure that /var has its own partition
or logical volume.</description>
<rationale>
Ensuring that /var is mounted on its own partition enables the setting of more restrictive 
mount options, which is used as temporary storage
by many program, particularly system services such as daemons.
It is not uncommon for
the /var directory to contain world-writable directories, installed
by other software packages. 
</rationale>
<ident cce="14777-7" />
<oval id="20002" />
<ref nist="CM-6"/>
</Rule>

<Rule id="partition_for_var_log">
<title>Ensure that /var/log has its own partition or
logical volume</title>
<description>System logs are stored in the /var/log directory.
Ensure that it has its own partition or logical
volume.</description>
<ident cce="14011-1" />
<oval id="20004" />
<ref nist="CM-6, AU-9"/>
</Rule>

<Rule id="partition_for_var_log_audit">
<title>Ensure that /var/log/audit has its own partition
or logical volume</title>
<description>Audit logs are stored in the /var/log/audit directory.
Ensure that it has its own partition or logical volume. Make
absolutely certain that it is large enough to store all audit logs
that will be created by the auditing daemon.</description>
<ident cce="14171-3" />
<oval id="20005" />
<ref nist="CM-6, AU-9"/>
</Rule>

<Rule id="partition_for_home">
<title>Ensure that /home has its own partition or
logical volume</title>
<description>If user home directories will be stored locally,
create a separate partition for /home. If /home will be mounted
from another system such as an NFS server, then creating a separate
partition is not necessary at this time, and the mountpoint can
instead be conﬁgured later.</description>
<ident cce="14559-9" />
<oval id="20006" />
<ref nist="CM-6"/>
</Rule>
</Group>

<Group id="updating_software">
<title>Updating Software</title>
<description>The yum command line tool is used to install and
update software packages. Yum replaces the up2date utility used in
previous system releases. The system also provides two graphical
package managers, pirut and pup. The pirut tool is a graphical
front-end for yum that allows users to install and update packages
while pup is a simple update tool for packages that are already
installed. In the
<b>Applications</b> menu, pirut is labeled
<b>Add/Remove Software</b> and pup is labeled
<b>Software Updater</b>.
<br />
<br />It is recommended that these tools be used to keep systems up
to date with the latest security patches.</description>
<Rule id="ensure_redhat_gpgkey_installed">
<title>Ensure Red Hat GPG Key is Installed</title>
<description>The GPG key should be installed.</description>
<rationale>
This key is necessary to cryptographically verify that packages 
are from Red Hat.
</rationale>
<ident cce="14440-2"/>
<oval id="200065" />
<ref nist="SI-2, SI-7, SC-13"/>
</Rule>

<Rule id="disable_rhnsd">
<title>Disable the rhnsd Daemon</title>
<description>The rhnsd daemon polls the Red Hat Network web site
for scheduled actions. Unless it is actually necessary to schedule
updates remotely through the RHN website, it is recommended that
the service be disabled.</description>
<ident cce="3416-5" />
<oval id="20007" />
<ref nist="CM-6, CM-7"/>
</Rule>

<Rule id="security_patches_up_to_date">
<title>Ensure software is up to date</title>
<description>The following command prints a list of packages that
need to be updated:
<br />
<br />
<code># yum check-update</code>
<br />
<br />To actually install these updates, run:
<br />
<br />
<code># yum update</code></description>
<ref nist="SI-2"/>
<oval id="" />
</Rule>

<Rule id="disable_yum-updatesd">
<title>The yum-updatesd service should be disabled</title>
<description>The yum-updatesd service is not mature enough for an
enterprise environment, and the service may introduce unnecessary
overhead. When possible, replace this service with a cron job that
calls yum directly.</description>
<ident cce="4218-4" />
<oval id="20008" />
<ref nist="CM-6, CM-7, SI-2"/>
</Rule>

<Rule id="ensure_gpgcheck_globally_activated">
<title>Ensure gpgcheck is Globally Activated</title>
<description>The gpgcheck option should be used to ensure that
checking of an RPM package’s signature always occurs prior to its
installation.
<br />
<br />To force yum to check package signatures before installing
them, ensure that the following line appears in /etc/yum.conf in
the [main] section:
<br />
<br />gpgcheck=1</description>
<ident cce="14914-6" />
<oval id="20010" />
<ref nist="SI-2"/>
</Rule>

<Rule id="ensure_gpgcheck_never_disabled">
<title>Ensure Package Signature Checking is Not
Disabled For Any Repos</title>
<description>To ensure that signature checking is not disabled for
any repos, ensure that the following line DOES NOT appear in any
repo conﬁguration ﬁles in /etc/yum.repos.d or elsewhere:
<br />
<br />gpgcheck=0</description>
<ident cce="14813-0" />
<oval id="20011" />
<ref nist="SI-2"/>
</Rule>

</Group>

<Group id="software_integrity">
<title>Software Integrity Checking</title>
<description>The AIDE (Advanced Intrusion Detection Environment)
software is included with the system to provide software integrity
checking. It is designed to be a replacement for the well-known
Tripwire integrity checker. Integrity checking cannot
<i>prevent</i>intrusions into your system, but can detect that
they have occurred.
<br />
<br />Any integrity checking software should be configured before
the system is deployed and able to provides services to users.
Ideally, the integrity checking database would be built before the
system is connected to any network, though this may prove
impractical due to registration and software updates.</description>

<Rule id="install_aide">
<title>Install AIDE</title>
<description>Requirements for software integrity checking should be
defined by policy, and this is highly dependent on the environment
in which the system will be used. As such, a general strategy for
implementing integrity checking is provided, but precise
recommendations (such as to check a particular file) cannot be.
Documentation for AIDE, including the quick-start on which this
advice is based, is available in
/usr/share/doc/aide-0.12.</description>
<ident cce="4209-3" />
<oval id="20014" />
<ref nist="CM-6, CM-7"/>
</Rule>

<Rule id="verify_package_integrity">
<title>erify Package Integrity Using RPM</title>
<description>The RPM package management system includes the ability
to verify the integrity of installed packages by comparing the
installed ﬁles with information about the ﬁles taken from the
package metadata stored in the RPM database. Although an attacker
could corrupt the RPM database (analogous to attacking the AIDE
database as described above), this check can still reveal
modiﬁcation of important ﬁles.</description>
<ident cce="14931-0" />
<oval id="200155" />
<ref nist="SI-7"/>
</Rule>
</Group>

</Group>


