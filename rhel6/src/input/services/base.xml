<Group id="base">
<title>Base Services</title>
<description>
When building new servers it is best practice to start out with an absolute basic operating system installation. From this basic point the system is built out to meet it's designed purpose such as a DNS server, MySQL/PostgreSQL database server, or Apache web server. The RHEL 6 installer now comes with an option that will install a minimal Linux environment. The purpose of this section is to document the services that are installed by default on a RHEL 6 system that was built with the "Minimal" package configuration during operating system installation. Overall, the "Minimal" package configuration serves as an excellent starting point. Here is the output from the chkconfig utility showing the services that are installed by default on a minimal RHEL 6 system:
<pre>
# /sbin/chkconfig --list
auditd          0:off 1:off 2:on  3:on  4:on  5:on  6:off
crond           0:off 1:off 2:on  3:on  4:on  5:on  6:off
ip6tables       0:off 1:off 2:on  3:on  4:on  5:on  6:off
iptables        0:off 1:off 2:on  3:on  4:on  5:on  6:off
lvm2-monitor    0:off 1:on  2:on  3:on  4:on  5:on  6:off
netconsole      0:off 1:off 2:off 3:off 4:off 5:off 6:off
netfs           0:off 1:off 2:off 3:on  4:on  5:on  6:off
network         0:off 1:off 2:on  3:on  4:on  5:on  6:off
postfix         0:off 1:off 2:on  3:on  4:on  5:on  6:off
rdisc           0:off 1:off 2:off 3:off 4:off 5:off 6:off
restorecond     0:off 1:off 2:off 3:off 4:off 5:off 6:off
rhnsd           0:off 1:off 2:on  3:on  4:on  5:on  6:off
rhsmcertd       0:off 1:off 2:off 3:on  4:on  5:on  6:off
rsyslog         0:off 1:off 2:on  3:on  4:on  5:on  6:off
saslauthd       0:off 1:off 2:off 3:off 4:off 5:off 6:off
sshd            0:off 1:off 2:on  3:on  4:on  5:on  6:off
udev-post       0:off 1:on  2:on  3:on  4:on  5:on  6:off
</pre>
As you can see, the "Minimal" package configuration in RHEL 6 lives up to its name. The system services listed above are for the most part the bare essentials needed for a running system. Each one of these services will be discussed and a specific recommendation will be made as to whether the service should
be enabled or not.
</description>

<Group id="base_service_abrtd">
<title>Automatic Bug Reporting Tool (abrtd)</title>
<description>The Automatic Bug Reporting Tool (abrtd) is a daemon that collects and reports crash data
when an application crash is detected. Using a variety of plugins abrtd can email crash reports to system
administrators, log crash reports to files, or forward crash reports to a centralized issue tracking
system such as RHTSupport. Mishandling crash data exposes sensitive information about vulnerablities in
software executing on the local machine. For most deployments this daemon should be disabled.
<pre>
# chkconfig abrtd off

</pre>
</description>
  <Rule id="service_abrtd_disabled">
    <title>Daemon <tt>abrtd</tt> Disabled</title>
    <description>The <tt>abrtd</tt> daemon should be disabled.</description>
    <ident cce="TODO" />
    <oval id="service_abrtd_disabled" />
  </Rule>
</Group>

<Group id="base_service_acpid">
<title>Advanced Configuration and Power Interface Daemon (acpid)</title>
<description>The Advanced Configuration and Power Interface Daemon (acpid) dispatches ACPI events (such
as power/reset button depressed) to userspace programs. Unless trapping ACPI events is a requirement
on the local system this daemon should be disabled.
<pre>
# chkconfig acpid off

</pre>
</description>
  <Rule id="service_acpid_disabled">
    <title>Daemon <tt>acpid</tt> Disabled</title>
    <description>The <tt>acpid</tt> daemon should be disabled.</description>
    <ident cce="4298-6" />
    <oval id="service_acpid_disabled" />
  </Rule>
</Group>

<Group id="base_service_atd">
<title>At Daemon (atd)</title>
<description>The <tt>at</tt> and <tt>batch</tt> commands can be used to schedule tasks that are meant
to be executed only once (similar to cron but not recurring). The daemon <tt>atd</tt> keeps track of
tasks scheduled via <tt>at</tt> and <tt>batch</tt> and executes them at the specified time. Unless
scheduling tasks with <tt>at</tt> or <tt>batch</tt> is a requirement for the local machine this
daemon should be disabled.
<pre>
# chkconfig atd off

</pre>
</description>
  <Rule id="service_atd_disabled">
    <title>Daemon <tt>atd</tt> Disabled</title>
    <description>The <tt>atd</tt> daemon should be disabled.</description>
    <ident cce="TODO" />
    <oval id="service_atd_disabled" />
  </Rule>
</Group>

<Group id="base_service_auditd">
<title>Audit Daemon (auditd)</title>
<description>
The audit service is provided for system auditing. By default the service audits SELinux AVC denials and certain types of security-relevant events such as system logins, account modifications, and authentication events performed by programs such as sudo. Unless there is another service that will be used for system auditing it is recommended that auditd be enabled.
<pre># chkconfig auditd on</pre>
</description>
</Group>

<Group id="base_service_crond">
<title>Cron Daemon (crond)</title>
<description>
The cron daemon is used to execute commands at preconfigured times. The cron daemon is required by almost all systems to perform necessary maintenance tasks. The daemon should be configured defensively.
<pre># chkconfig crond on</pre>
</description>
</Group>

<Group id="base_service_firewall">
<title>Firewall (iptables and ip6tables)</title>
<description>
The kernel distributed with RHEL 6 comes with Netfilter's packet filtering framework. The framework consists of two components: a set of kernel modules that perform the actual packet filtering, and a set of userspace tools used to administer the firewall ruleset. The most common userspace tools are <tt>iptables</tt> and <tt>ip6tables</tt> used to adminster the IPv4 tables and IPv6 tables respectively. Packet filtering occurs at the kernel level before a program can even process the data from the network packet. As such, any program on the system is affected by the rules written. It is highly recommended to leave these services enabled.
<pre># chkconfig iptables on
# chkconfig ip6tables on</pre>
Please note that both IPv4 and IPv6 network stacks are installed by default. There are two ways to determine if the local machine is dual stacked. You can examine the output of the <tt>lsmod</tt> command and look for a module called <tt>ipv6</tt>. You can also examine the output of <tt>ifconfig</tt> to see if network interfaces have both IPv4 and IPv6 addresses. This output from the <tt>ifconfig</tt> command shows that the local system is dual stacked. Notice how the loopback interface <tt>lo</tt> has both IPv4 and IPv6 addresses: <pre>lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host</pre>
If IPv6 is not required then it should be disabled. If disabling IPv6 is not feasible for some reason, it is important to leave both services enabled even though the server or workstation sits on either a IPv4 network or a IPv6 network. If the machine is sitting on an IPv4 network then use <tt>ip6tables</tt> to completely close down the IPv6 side of things. If the machine is sitting on an IPv6 network then use <tt>iptables</tt> to close down the IPv4 side of things.
<br />
Finally, it is not enough to simply enable the iptables and ip6tables services and walk away. The Netfilter packet filtering framework within the Linux kernel allows for a wide variety of firewall configurations. Taking the time to configure a robust host-based firewall is well worth the effort.
</description>
</Group>

<Group id="base_service_lvm2-monitor">
<title>Logical Volume Management Monitor (lvm2-monitor)</title>
<description>
The lvm2-monitor service can be used to start or stop monitoring a mirrored or snapshot logical volume with dmeventd, if it is installed. If a device used by a monitored mirror reports an I/O error, the failure is handled according to "mirror_image_fault_policy" and "mirror_log_fault_policy" set in the /etc/lvm/lvm.conf configuration file.
<br />
If the system utilizes mirrored or snapshot logical volumes then this service should be configured and enabled.
<pre># chkconfig lvm2-monitor on</pre>
If the system does not use mirrored or snapshot logical volumes then this service can be disabled.
<pre># chkconfig lvm2-monitor off</pre>
</description>
</Group>

<Group id="base_service_netconsole">
<title>Network Console (netconsole)</title>
<description>
The netconsole service is responsible for loading the netconsole kernel module which logs kernel printk messages over UDP to a syslog server. This allows debugging of problems where disk logging fails and serial consoles are impractical. This service should not be needed unless you need to debug kernel panics. In general this service should be disabled.
<pre># chkconfig netconsole off</pre>
</description>
</Group>

<Group id="base_service_netfs">
<title>Network File Systems (netfs)</title>
<description>
The netfs script manages the boot-time mounting of several types of networked filesystems, of which NFS and Samba are the most common. If these filesystem types are not in use, the script can be disabled, protecting the system somewhat against accidental or malicious changes to /etc/fstab and against flaws in the netfs script itself.
<br />
To determine if any network filesystems handled by netfs are currently mounted on the system execute the following command:
<pre># mount -t nfs,nfs4,smbfs,cifs,ncpfs</pre>
If the command did not return any output then disable netfs:
<pre># chkconfig netfs off</pre></description>
</Group>

<Group id="base_service_network">
<title>Network (network)</title>
<description>
The network service is made up of a series of scripts and configuration files that are used to configure network interfaces upon system boot. If the system does not need any sort of networking then this service can be disabled. Otherwise, this service can be left enabled.
<pre># chkconfig network on</pre>
</description>
</Group>

<Group id="base_service_postfix">
<title>Postfix (postfix)</title>
<description>
The Postfix mail transfer agent is used for local mail delivery within the system. The default configuration only listens for connections to the default SMTP port (port 25) on the loopback interface (127.0.0.1). It is recommended to leave this service enabled for local mail delivery.
<pre># chkconfig postfix on</pre>
</description>
</Group>

<Group id="base_service_rdisc">
<title>Network Router Discovery Daemon (rdisc)</title>
<description>
The rdisc daemon implements the client side of the ICMP Internet Router Discovery Protocol (IRDP). The daemon can be used to discover routers on the local subnet. If a router is discovered then the local routing table is updated with a corresponding default route. By default this daemon is disabled and it should remain disabled. Servers should have their network and routing information configured by a system administrator in correspondence with the local network management policy. Workstations should use DHCP if they require dynamic network configuration information.
<pre># chkconfig rdisc off</pre>
</description>
</Group>

<Group id="base_service_rhnsd">
<title>Red Hat Update Agent (rhnsd)</title>
<description>
The Red Hat Update Agent is a network aware application that automatically queries Red Hat Network servers to determine which packages need to be updated on your machine. More than likely this would be an undesired behavior on production systems where patches must be tested before application. It is recommended to disable this service and perform patching in accordance with local configuration management policy.
<pre># chkconfig rhnsd on</pre>
</description>
</Group>

<Group id="base_service_rhsmcertd">
<title>Red Hat Subscription Manager Daemon (rhsmcertd)</title>
<description>
The Red Hat Subscription Manager (rhsmcertd) runs routinely to check for changes in the entitlements for an organization. Like the Red Hat Update Agent, it is recommended to also disable this service.
<pre># chkconfig rhsmcertd on</pre>
</description>
</Group>

<Group id="base_service_rsyslog">
<title>Syslog Daemon (rsyslog)</title>
<description>
The rsyslog service provides the default logging daemon for RHEL 6. Unless some sort of custom logging daemon is used (like syslog-ng or something similar) then this service must be enabled and configured properly. The rsyslog service provides improvements such as connection-oriented (TCP) transmission of logs, the option to log to database formats, and the encryption of log data en route to a central logging server.
<pre># chkconfig rsyslog on</pre>
</description>
</Group>

<Group id="base_service_saslauthd">
<title>Cyrus SASL Authentication Daemon (saslauthd)</title>
<description>
The saslauthd service handles plaintext authentication requests on behalf of the SASL library.
This service fulfills two roles: 1) it isolates all code requiring superuser privileges into a single process, and 2) it can be used to provide proxy authentication services to clients that do not
understand SASL based authentication. Unless this service is absolutely needed it should be disabled.
<pre># chkconfig saslauthd off</pre>
</description>
</Group>

<Group id="base_service_sshd">
<title>OpenSSH Daemon (sshd)</title>
<description>
The Secure Shell (SSH) protocol is recommended for remote login and remote file transfer. SSH provides confidentiality and integrity for data exchanged between two systems, as well as server authentication, through the use of public key cryptography. The implementation included with the system is called OpenSSH. If remote administration is needed then this service should be enabled.
<pre># chkconfig sshd on</pre>
</description>
</Group>

<Group id="base_service_udev-post">
<title>Device Manager (udev-post)</title>
<description>
The udev service serves as the device manager. It maintains a set of devices that are normally located in the /dev directory. This service should be enabled.
<pre># chkconfig udev-post on</pre>
</description>
</Group>

<!--
##### OLDER CONTENT LEFT HERE FOR TEMPORARY REFERENCE #####

<Group id="isdn">
<title>ISDN Support (isdn)</title>
<description>The ISDN service facilitates Internet connectivity in
the presence of an ISDN modem. If an ISDN modem is not being used,
disable this service:
<br /><br />
<code># chkconfig isdn off</code>
</description>
<Rule id="disable_isdn">
<title>ISDN Support (isdn)</title>
<description>The isdn service should be disabled.</description>
<ident cce="4286-1" />
<oval id="package_isdn4k-utils_removed" />
<ref nist="CM-6, CM-7" />
</Rule>
</Group>

<Group id="kdump">
<title>Kdump Kernel Crash Analyzer (kdump)</title>
<description>Kdump is a new kernel crash dump analyzer. It uses
kexec to boot a secondary kernel ('capture' kernel) following a
system crash. The kernel dump from the system crash is loaded into
the capture kernel for analysis.
<br /><br />
Unless the system is used for kernel development or testing,
disable the service:
<br /><br />
<code># chkconfig kdump off</code>
</description>
<Rule id="disable_kdump">
<title>Kdump Kernel Crash Analyzer (kdump)</title>
<description>The kdump service should be disabled.</description>
<ident cce="3425-6" />
<oval id="service_kdump_disabled" />
<ref nist="CM-6, CM-7" />
</Rule>
</Group>

<Group id="network_service">
<title>Network Service (network)</title>
<description>The network service allows associated network
interfaces to access the network. This section contains general
guidance for controlling the operation of the service. For kernel
parameters which affect networking, see Section</description>
<Group id="zeroconf_service">
<title>Disable Zeroconf Networking</title>
<description>Zeroconf networking allows the system to assign itself
an IP address and engage in IP communication without a
statically-assigned address or even a DHCP server. Automatic
address assignment via Zeroconf (or DHCP) is not recommended.
<br /><br />
To disable Zeroconf automatic route assignment in the
169.245.0.0 subnet, add or correct the following line in
<tt>/etc/sysconfig/network</tt>:
<br />
<pre>
NOZEROCONF=yes

</pre>
Zeroconf addresses are in the network 169.254.0.0. The
networking scripts add entries to the system's routing table for
these addresses. Zeroconf address assignment commonly occurs when
the system is configured to use DHCP but fails to receive an
address assignment from the DHCP server.</description>
<Rule id="disable_zeroconf">
<title>Disable Zeroconf Networking</title>
<description>Disable Zeroconf automatic route assignment in the
169.245.0.0 subnet.</description>
<ident cce="14054-1" />
<oval id="sysconfig_nozeroconf_yes" />
<ref nist="CM-6, CM-7" />
</Rule>
</Group>
</Group>

<Group id="boot_caching_services">
<title>Boot Caching (readahead early/readahead later)</title>
<description>The following services provide one-time caching of
files belonging to some boot services, with the goal of allowing
the system to boot faster.
<br /><br />
It is recommended that this service be disabled on most
machines:
<br /><br />
<pre>
# chkconfig readahead_early off
# chkconfig readahead_later off

</pre>
The readahead services do not substantially increase a
system's risk exposure, but they also do not provide great benefit.
Unless the system is running a specialized application for which
the file caching substantially improves system boot time, this
guide recommends disabling the services.</description>

<Rule id="disable_readahead_early">
<title>Boot Caching (readahead early/readahead
later)</title>
<description>The readahead_early service should be
disabled.</description>
<ident cce="4421-4" />
<oval id="service_readahead_early_disabled" />
<ref nist="CM-6, CM-7" />
</Rule>

<Rule id="disable_readahead_later">
<title>Boot Caching (readahead early/readahead later)</title>
<description>The readahead_later service should be
disabled.</description>
<ident cce="4302-6" />
<oval id="service_readahead_later_disabled" />
<ref nist="CM-6, CM-7" />
</Rule>
</Group>
<Group id="bluetooth">
<title>Bluetooth Support</title>
<description>Bluetooth provides a way to transfer information
between devices such as mobile phones, laptops, PCs, printers,
digital cameras, and video game consoles over a short-range
wireless link. Any wireless communication presents a serious
security risk to sensitive or classified systems. Section 2.5.2
contains information on the related topic of wireless networking.
<br /><br />
Removal of hardware is the only way to ensure that the
Bluetooth wireless capability remains disabled. If it is completely
impractical to remove the Bluetooth hardware module, and site
policy still allows the device to enter sensitive spaces, every
effort to disable the capability via software should be made. In
general, acquisition policy should include provisions to prevent
the purchase of equipment that will be used in sensitive spaces and
includes Bluetooth capabilities.</description>
<Group id="bluetooth_service">
<title>Bluetooth Host Controller Interface Daemon (bluetooth)</title>
<description>The bluetooth service enables the system to use
Bluetooth devices. If the system requires no Bluetooth devices,
disable this service:
<br />
<pre>
# chkconfig bluetooth off</pre>
</description>
<Rule id="disable_bluetooth_service">
<title>Bluetooth Host Controller Interface Daemon
(bluetooth)</title>
<description>The bluetooth service should be
disabled.</description>
<ident cce="4355-4" />
<oval id="service_bluetooth_disabled" />
<ref nist="CM-6, CM-7" />
</Rule>
</Group>


<Group id="bluetooth_hidd">
<title>Bluetooth Input Devices (hidd)</title>
<description>The hidd service provides support for Bluetooth input
devices. If the system has no Bluetooth input devices (e.g.
keyboard or mouse), disable this service:
<br />
<pre>
# chkconfig hidd off</pre>
</description>
<Rule id="disable_bluetooth_hidd">
<title>Bluetooth Input Devices (hidd)</title>
<description>The hidd service should be disabled.</description>
<ident cce="4377-8" />
<oval id="service_hidd_disabled" />
<ref nist="CM-6, CM-7" />
</Rule>
</Group>
-->

</Group>
