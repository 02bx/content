<Group id="dhcp">
<title>DHCP</title>
<description>The Dynamic Host Configuration Protocol (DHCP) allows
systems to request and obtain an IP address and other configuration 
parameters from a server.
<br /><br />
In general, sites use DHCP either to allow a large pool of
mobile or unknown machines to share a limited number of IP
addresses, or to standardize installations by avoiding static,
individual IP address configuration on hosts. It is recommended
that sites avoid DHCP as much as possible. Since DHCP
authentication is not well-supported, DHCP clients are open to
attacks from rogue DHCP servers. Such servers can give clients
incorrect information (e.g. malicious DNS server addresses) which
could lead to their compromise.
<br /><br />
If a machine must act as a DHCP client or server, configure
it defensively using the guidance in this section. This guide
recommends configuring networking on clients by manually editing
the appropriate files under <tt>/etc/sysconfig</tt>. It is also possible to
use the graphical front-end programs system-config-network and
system-config-network-tui, but these programs rewrite configuration
files from scratch based on their defaults – destroying any manual
changes – and should therefore be used with caution.</description>


<Group id="disabling_dhcp_server">
<title>Disable DHCP Server if Possible</title>
<description>
The DHCP server <tt>dhcpd</tt> is not installed or activated by
default. If the software was installed and activated, but the
system does not need to act as a DHCP server, it should be disabled
and removed. 
</description>

<Rule id="disable_dhcp_server">
<title>Disable DHCP Service</title>
<description>The <tt>dhcpd</tt> service should be disabled on 
any system that does not need to act as a DHCP server.
To do so, run the command:
<pre>
# chkconfig dhcpd off
</pre>
</description>
<rationale>
Unmanaged or unintentionally activate DHCP servers may provide faulty information
to clients, interfering with the operation of a legitimate site
DHCP server if there is one. 
</rationale>
<ident cce="4336-4" />
<oval id="service_dhcpd_disabled" />
<ref nist="CM-6, CM-7" />
</Rule>

<Rule id="uninstall_dhcp_server">
<title>Uninstall DHCP Server Package</title>
<description>If the system does not need to act as a DHCP server, 
the dhcp package can be uninstalled.
To do so, run the command:
<pre>
# yum erase dhcp
</pre>
</description>
<rationale>
Removing the DHCP server ensures that it cannot be easily or 
accidentally reactivated and disrupt network operation.
</rationale>
<ident cce="4464-4" />
<oval id="package_dhcpd_removed" />
<ref nist="CM-6, CM-7" />
</Rule>
</Group>


<Group id="disabling_dhcp_client">
<title>Disable DHCP Client if Possible</title>
<description>
DHCP is the default network configuration method provided by the system 
installer, and common on many networks.  Nevertheless, manual management 
of IP addresses for systems implies a greater degree of management and 
accountability for network activity.
</description>

<Rule id="disable_dhcp_client">
<title>Disable DHCP Client</title>
<description>
For each interface <i>IFACE</i> on the system (e.g. eth0), 
edit <tt>/etc/sysconfig/network-scripts/ifcfg-<i>IFACE</i></tt> and make the following changes:
<ul>
<li> Correct the BOOTPROTO line to read: 
<pre>BOOTPROTO=static</pre>
</li>
<li> Add or correct the following lines, substituting the appropriate 
values based on your site’s addressing scheme:
<pre>
NETMASK=255.255.255.0 
IPADDR=192.168.1.2 
GATEWAY=192.168.1.1
</pre>
</li>
</ul>
</description>
<rationale>
DHCP is inherently insecure and should not be used unless it presents an unacceptable burden to the organization.
</rationale>
<ident cce="4191-3" />
<oval id="sysconfig_networking_bootproto_ifcfg" />
<ref nist="CM-6, CM-7" />
</Rule>
</Group>

</Group>
