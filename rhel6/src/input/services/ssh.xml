<Group id="ssh">
<title>SSH Server</title>
<description>The SSH protocol is recommended for remote login and
remote file transfer. SSH provides confidentiality and integrity
for data exchanged between two systems, as well as server
authentication, through the use of public key cryptography. The
implementation included with the system is called OpenSSH, and more
detailed documentation is available from its website,
http://www.openssh.org. Its server program is called sshd and
provided by the RPM package openssh-server.</description>
<Group id="ssh_server">
<title>Configure OpenSSH Server if Necessary</title>
<description>If the system needs to act as an SSH server, then
certain changes should be made to the OpenSSH daemon configuration
file /etc/ssh/sshd config. The following recommendations can be
applied to this file. See the sshd config(5) man page for more
detailed information.</description>
<Group id="sshd_allowing_only_protocol2">
<title>Ensure Only Protocol 2 Connections Allowed</title>
<description>Only SSH protocol version 2 connections should be
permitted. Version 1 of the protocol contains security
vulnerabilities. The default setting shipped in the configuration
file is correct, but it is important enough to check.
<br />
<br />Verify that the following line appears:
<br />
<br />Protocol 2</description>
<Rule id="sshd_allow_only_protocol2">
<title>Ensure Only Protocol 2 Connections
Allowed</title>
<description>SSH version 1 protocol support should be
disabled.</description>
<ident cce="4325-7" />
<oval id="20238" />
</Rule>
</Group>
<Group id="group-3.5.2.3">
<title>Set Idle Timeout Interval for User Logins</title>
<description>SSH allows administrators to set an idle timeout
interval. After this interval has passed, the idle user will be
automatically logged out.
<br />
<br />Find and edit the following lines in /etc/ssh/sshd config as
follows:
<br />
<br />ClientAliveInterval interval
<br />ClientAliveCountMax 0
<br />
<br />The timeout interval is given in seconds. To have a timeout
of 5 minutes, set interval to 300.
<br />
<br />If a shorter timeout has already been set for the login
shell, as in Section 2.3.5.5, that value will preempt any SSH
setting made here. Keep in mind that some processes may stop SSH
from correctly detecting that the user is idle.</description>
<Value id="var-3.5.2.3.a" type="number"
operator="equals" interactive="0">
<title>SSH session Idle time</title>
<description>Specify duration of allowed idle time.</description>
<value selector="">300</value>
<value selector="5_minutes">300</value>
<value selector="10_minutes">600</value>
</Value>

<Rule id="sshd_set_idle_timeout">
<title>The SSH idle timout interval should be set to an
appropriate value</title>
<description>The SSH idle timout interval should be set to an
appropriate value</description>
<ident cce="3845-5" />
<oval id="20239" />
</Rule>

<Rule id="sshd_set_keepalive">
<title>The SSH 'keep alive' message count should be set
to an appropriate value</title>
<description>The ClientAliveCountMax should be set to an
appropriate value</description>
<ident cce="14061-6" />
<oval id="20240" />
</Rule>
</Group>

<Group id="sshd_disabling_rhosts">
<title>Disable .rhosts Files</title>
<description>SSH can emulate the behavior of the obsolete rsh
command in allowing users to enable insecure access to their
accounts via .rhosts files.
<br />
<br />To ensure that this behavior is disabled, add or correct the
following line:
<br />
<br />IgnoreRhosts yes</description>
<Rule id="sshd_disable_rhosts">
<title>Disable .rhosts Files</title>
<description>Emulation of the rsh command through the ssh server
should be disabled</description>
<ident cce="4475-0" />
<oval id="20241" />
</Rule>
</Group>

<Group id="disabling_host_auth">
<title>Disable Host-Based Authentication</title>
<description>SSH's cryptographic host-based authentication is
slightly more secure than .rhosts authentication, since hosts are
cryptographically authenticated. However, it is not recommended
that hosts unilaterally trust one another, even within an
organization.
<br />
<br />To disable host-based authentication, add or correct the
following line:
<br />
<br />HostbasedAuthentication no</description>
<Rule id="disable_host_auth">
<title>Disable Host-Based Authentication</title>
<description>SSH host-based authentication should be
disabled</description>
<ident cce="4370-3" />
<oval id="20242" />
</Rule>
</Group>
<Group id="sshd_disabling_root_login">
<title>Disable root Login via SSH</title>
<description>The root user should never be allowed to login
directly over a network, as this both reduces auditable information
about who ran privileged commands on the system and allows direct
attack attempts on root's password.
<br />
<br />To disable root login via SSH, add or correct the following
line:
<br />
<br />PermitRootLogin no</description>


<Rule id="sshd_disable_root_login">
<title>Disable root Login via SSH</title>
<description>Root login via SSH should be disabled</description>
<ident cce="4387-7" />
<oval id="20243" />
</Rule>
</Group>
<Group id="sshd_disabling_empty_passwords">
<title>Disable Empty Passwords</title>
<description>To explicitly disallow remote login from accounts with
empty passwords, add or correct the following line:
<br />
<br />PermitEmptyPasswords no
<br />
<br />Measures should also be taken to disable accounts with empty
passwords system-wide, as described in Section
2.3.1.5.</description>

<Rule id="sshd_disable_empty_passwords">
<title>Disable Empty Passwords</title>
<description>Remote connections from accounts with empty passwords
should be disabled</description>
<ident cce="3660-8" />
<oval id="20244" />
</Rule>
</Group>
<Group id="sshd_enabling_warning_banner">
<title>Enable a Warning Banner</title>
<description>Section 2.3.7 contains information on how to create an
appropriate warning banner.
<br />
<br />To enable a warning banner, add or correct the following
line:
<br />
<br />Banner /etc/issue</description>
<Rule id="sshd_enable_warning_banner">
<title>Enable a Warning Banner</title>
<description>SSH warning banner should be enabled</description>
<ident cce="4431-3" />
<oval id="20245" />
</Rule>
</Group>
<Group id="sshd_permitting_user_env">
<title>Do Not Allow Users to Set Environment Options</title>
<description>To prevent users from being able to present
environment options to the SSH daemon and potentially bypass some
access restrictions, add or correct the following line:
<br />
<br />PermitUserEnvironment no</description>
<Rule id="sshd_do_not_permit_user_env">
<title>Do Not Allow Users to Set Environment
Options</title>
<description>PermitUserEnvironment should be disabled</description>
<ident cce="4422-2" />
<oval id="202455" />
</Rule>
</Group>
<Group id="sshd_using_approved_ciphers">
<title>Use Only Approved Ciphers</title>
<description>Limit the ciphers to those which are FIPS-approved and
only use ciphers in counter (CTR) mode. The following line
demonstrates use of FIPS-approved ciphers in CTR mode:
<br />
<br />Ciphers aes128-ctr,aes192-ctr,aes256-ctr
<br />
<br />The man page sshd_config(5) contains a list of the ciphers
supported for the current release of the SSH daemon.</description>


<Rule id="sshd_use_approved_ciphers">
<title>Use Only Approved Ciphers</title>
<description>Use only FIPS approved ciphers not in CBC
mode</description>
<ident cce="14491-5" />
<oval id="202456" />
</Rule>
</Group>
</Group>
</Group>



