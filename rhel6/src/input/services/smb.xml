<Group id="smb">
<title>Samba(SMB) Microsoft Windows File Sharing Server</title>
<description>When properly configured, the Samba service allows
Linux machines to provide file and print sharing to Microsoft
Windows machines. There are two software packages that provide
Samba support. The first, <tt>samba-client</tt>, provides a series of
command line tools that enable a client machine to access Samba
shares. The second, simply labeled samba, provides the Samba
service. It is this second package that allows a Linux machine to
act as an Active Directory server, a domain controller, or as a
domain member. Only the <tt>samba-client</tt> package is installed by
default.</description>
<Group id="disabling_samba">
<title>Disable Samba if Possible</title>
<description>If the Samba service has been enabled and will not be
used, disable it:
<br />
<pre>
# chkconfig smb off

</pre>
Even after the Samba server package has been installed, it
will remain disabled. Do not enable this service unless it is
absolutely necessary to provide Microsoft Windows file and print
sharing functionality.</description>
<Rule id="disable_smb_server">
<title>Disable Samba if Possible</title>
<description>The <tt>smb</tt> service should be disabled.</description>
<ident cce="4551-8" />
<oval id="service_smb_disabled" />
</Rule>
</Group>
<Group id="configuring_samba">
<title>Configure Samba if Necessary</title>
<description>All settings for the Samba daemon can be found in
<tt>/etc/samba/smb.conf</tt>. Settings are divided between a
<tt>[global]</tt> configuration section and a series of user
created share definition sections meant to describe file or print
shares on the system. By default, Samba will operate in user mode
and allow client machines to access local home directories and
printers. It is recommended that these settings be changed or that
additional limitations be set in place.</description>
<Group id="smb_client_signing">
<title>Require Client SMB Packet Signing, if using
<tt>smbclient</tt></title>
<description>To require samba clients running <tt>smbclient</tt> to use
packet signing, add the following to the <tt>[global]</tt> section
of the Samba configuration file:
<br />
<pre>
client signing = mandatory

</pre>
A Samba client should only communicate with servers who can
support SMB packet signing. Packet signing can prevent
man-in-the-middle attacks which modify SMB packets in
transit.</description>
<Rule id="require_smb_client_signing">
<title>Require Client SMB Packet Signing, if using
<tt>smbclient</tt></title>
<description>Require samba clients running <tt>smbclient</tt> to use packet
signing. A Samba client should only communicate with servers who
can support SMB packet signing. Packet signing can prevent
man-in-the-middle attacks which modify SMB packets in
transit.</description>
<ident cce="14075-6" />
<oval id="smb_client_signing_smb_conf" />
</Rule>
</Group>

<Group id="smb_client_signing_mount.cifs">
<title>Require Client SMB Packet Signing, if using
<tt>mount.cifs</tt></title>
<description>Require packet signing of clients who mount Samba
shares using the <tt>mount.cifs</tt> program (e.g., those who specify shares
in <tt>/etc/fstab</tt>). To do so, ensure that signing options (either
<tt>sec=krb5i</tt> or <tt>sec=ntlmv2i</tt>) are used.
<br /><br />
See the <tt>mount.cifs(8)</tt> man page for more information. A Samba
client should only communicate with servers who can support SMB
packet signing. Packet signing can prevent man-in-the-middle
attacks which modify SMB packets in transit.</description>
<Rule id="require_smb_client_signing_mount.cifs">
<title>Require Client SMB Packet Signing, if using
mount.cifs</title>
<description>Require packet signing of clients who mount Samba
shares using the <tt>mount.cifs</tt> program (e.g., those who specify shares
in <tt>/etc/fstab</tt>). To do so, ensure that signing options (either
<tt>sec=krb5i</tt> or <tt>sec=ntlmv2i</tt>) are used.
<br /><br />
See the <tt>mount.cifs(8)</tt> man page for more information. A Samba
client should only communicate with servers who can support SMB
packet signing. Packet signing can prevent man-in-the-middle
attacks which modify SMB packets in transit.</description>
<ident cce="15029-2" />
<oval id="mount_option_smb_client_signing" />
</Rule>
</Group>
</Group>
</Group>

